<?xml version="1.0" encoding="utf-8" standalone="yes"?><search><entry><title>Supervisoræ‰˜ç®¡Djangoåº”ç”¨</title><url>http://next.lisenhui.cn/post/supervisor%E6%89%98%E7%AE%A1django%E5%BA%94%E7%94%A8/</url><categories/><tags/><content type="html"> Supervisor æ˜¯ç”¨Pythonå¼€å‘çš„ä¸€å¥—é€šç”¨çš„è¿›ç¨‹ç®¡ç†ç¨‹åºï¼Œèƒ½å°†ä¸€ä¸ªæ™®é€šçš„å‘½ä»¤è¡Œè¿›ç¨‹å˜ä¸ºåå°daemonï¼Œå¹¶ç›‘æ§è¿›ç¨‹çŠ¶æ€å¹¶ä¸”å¼‚å¸¸é€€å‡ºæ—¶èƒ½è‡ªåŠ¨é‡å¯ï¼Œä¹Ÿå¾ˆé€‚åˆéƒ¨ç½²celeryã€‚
ç¯å¢ƒ æœ¬æ–‡æ‰€æ¼”ç¤ºçš„ç¯å¢ƒæ–‡centosï¼Œpython2.7ç‰ˆæœ¬
å®‰è£… æœ¬æ–‡ä½¿ç”¨pipå®‰è£…ï¼Œä¹Ÿå¯ä½¿ç”¨yum
pip install supervisorå¤åˆ¶ä»£ç  å®‰è£…å®Œæ¯•åï¼ŒæŸ¥çœ‹ç‰ˆæœ¬å¦‚ä¸‹ï¼š
pip3 list | grep su supervisor 4.0.4 ä½¿ç”¨pipçš„å®‰è£…å¯èƒ½æ²¡æœ‰è®¾ç½®å¥½supervisorçš„ç¯å¢ƒå˜é‡ï¼Œè¿˜éœ€è¦æŸ¥çœ‹ä¸€ä¸‹supervisorå®‰è£…åçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶åœ¨å“ªé‡Œã€‚å¦‚æœäºŒè¿›åˆ¶æ–‡ä»¶æœ¬èº«å°±åœ¨/usr/binä¸‹å°±è¯´æ˜å·²ç»å®‰è£…å¥½äº†å¯ä»¥è·³è¿‡è½¯é“¾æ¥ã€‚
æœç´¢åœ¨ / ç›®å½•ä¸‹ï¼Œå‰åæ¨¡ç³ŠæŸ¥è¯¢åç§°ä¸º supervi çš„æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š find / -name "*supervi*" -ls | grep python3 | grep bin 405327 4 -rwxr-xr-x 1 root root 242 Oct 12 18:42 /usr/local/python3/bin/supervisorctl 405325 4 -rwxr-xr-x 1 root root 237 Oct 12 18:42 /usr/local/python3/bin/echo_supervisord_conf 405328 4 -rwxr-xr-x 1 root root 240 Oct 12 18:42 /usr/local/python3/bin/supervisord å°† supervisorctlã€echo_supervisord_conf å’Œ supervisord æ·»åŠ è½¯é“¾åˆ°æ‰§è¡Œç›®å½•ä¸‹/usr/bin ln -s /usr/local/python3/bin/echo_supervisord_conf /usr/bin/echo_supervisord_conf ln -s /usr/local/python3/bin/supervisord /usr/bin/supervisord ln -s /usr/local/python3/bin/supervisorctl /usr/bin/supervisorctl æ­¤æ—¶ç®—æ˜¯å®‰è£…å¥½äº†ã€‚
é…ç½® æˆ‘çš„åšæ³•æ˜¯å°†ä¸»é…ç½®æ–‡ä»¶æ”¾åœ¨/etc/supervisord.confä¸­ï¼Œåº”ç”¨é…ç½®æ–‡ä»¶æ”¾åœ¨/etc/supervisord.d/æ–‡ä»¶ä¸‹ã€‚echo_supervisord_confç”¨äºç”Ÿæˆé»˜è®¤é…ç½®ï¼Œæˆ‘ä»¬ç”Ÿæˆé»˜è®¤é…ç½®å¹¶å°†æœ€åä¸¤è¡Œå¼•å…¥å­è¿›ç¨‹é…ç½®æ–‡ä»¶çš„æ³¨è§†å»æ‰
mkdir /etc/supervisord.d echo_supervisord_conf > /etc/supervisord.conf supervisord.confä¸­ä¿®æ”¹çš„å†…å®¹
[include] files = supervisord.d/*.ini å†æ¥é…ç½®åº”ç”¨é…ç½®æ–‡ä»¶
# åˆ›å»ºæ–‡ä»¶ vim /etc/supervisord.d/demo.ini # æ–‡ä»¶ä¸­é…ç½®çš„å†…å®¹ [program:demo] command=/root/pyenv/demo/bin/gunicorn config.wsgi -c config/gunicorn_conf.py directory=/data/web/demo/coding ; directory to cwd to before exec (def no cwd) autostart=true ; start at supervisord start (default: true) autorestart=true ; retstart at unexpected quit (default: true) startsecs=10 ; number of secs prog must stay running (def. 1) startretries=3 ; max # of serial start failures (default 3) stopwaitsecs=600 ; max num secs to wait b4 SIGKILL (default 10) stdout_logfile=/logs/demo.log ; stdout log path, NONE for none; default AUTO æˆ‘ä½¿ç”¨çš„æ˜¯gunicornæ¥éƒ¨ç½²åº”ç”¨ï¼Œéœ€è¦åœ¨åº”ç”¨æ ¹ç›®å½•ä¸‹é…ç½®gunicorné…ç½®æ–‡ä»¶
# åˆ›å»ºæ–‡ä»¶ vim config/gunicorn_conf.py # æ–‡ä»¶å†…å®¹ # -*- coding: utf-8 -*- import multiprocessing bind = "0.0.0.0:8100" workers = 3 loglevel = "debug" worker_connections = 1000 timeout = 50 keepalive = 2 å¦å¤–è¿™é‡Œæ˜¯æˆ‘ä¸»é…ç½®æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼Œä»…ä¾›å‚è€ƒ
; Sample supervisor config file. ; ; For more information on the config file, please see: ; http://supervisord.org/configuration.html ; ; Notes: ; - Shell expansion ("~" or "$HOME") is not supported. Environment ; variables can be expanded using this syntax: "%(ENV_HOME)s". ; - Quotes around values are not supported, except in the case of ; the environment= options as shown below. ; - Comments must have a leading space: "a=b ;comment" not "a=b;comment". ; - Command will be truncated if it looks like a config file comment, e.g. ; "command=bash -c 'foo ; bar'" will truncate to "command=bash -c 'foo ". ; ; Warning: ; Paths throughout this example file use /tmp because it is available on most ; systems. You will likely need to change these to locations more appropriate ; for your system. Some systems periodically delete older files in /tmp. ; Notably, if the socket file defined in the [unix_http_server] section below ; is deleted, supervisorctl will be unable to connect to supervisord. [unix_http_server] file=/var/run/supervisor/supervisor.sock ; the path to the socket file ;chmod=0700 ; socket file mode (default 0700) ;chown=nobody:nogroup ; socket file uid:gid owner ;username=user ; default is no username (open server) ;password=123 ; default is no password (open server) ; Security Warning: ; The inet HTTP server is not enabled by default. The inet HTTP server is ; enabled by uncommenting the [inet_http_server] section below. The inet ; HTTP server is intended for use within a trusted environment only. It ; should only be bound to localhost or only accessible from within an ; isolated, trusted network. The inet HTTP server does not support any ; form of encryption. The inet HTTP server does not use authentication ; by default (see the username= and password= options to add authentication). ; Never expose the inet HTTP server to the public internet. ;[inet_http_server] ; inet (TCP) server disabled by default ;port=127.0.0.1:9001 ; ip_address:port specifier, *:port for all iface ;username=user ; default is no username (open server) ;password=123 ; default is no password (open server) [supervisord] logfile=/var/log/supervisor/supervisord.log ; main log file; default $CWD/supervisord.log logfile_maxbytes=50MB ; max main logfile bytes b4 rotation; default 50MB logfile_backups=10 ; # of main logfile backups; 0 means none, default 10 loglevel=info ; log level; default info; others: debug,warn,trace pidfile=/var/run/supervisord.pid ; supervisord pidfile; default supervisord.pid nodaemon=false ; start in foreground if true; default false silent=false ; no logs to stdout if true; default false minfds=1024 ; min. avail startup file descriptors; default 1024 minprocs=200 ; min. avail process descriptors;default 200 ;umask=022 ; process file creation umask; default 022 ;user=supervisord ; setuid to this UNIX account at startup; recommended if root ;identifier=supervisor ; supervisord identifier, default is 'supervisor' ;directory=/tmp ; default is not to cd during start ;nocleanup=true ; don't clean up tempfiles at start; default false ;childlogdir=/tmp ; 'AUTO' child log dir, default $TEMP ;environment=KEY="value" ; key value pairs to add to environment ;strip_ansi=false ; strip ansi escape codes in logs; def. false ; The rpcinterface:supervisor section must remain in the config file for ; RPC (supervisorctl/web interface) to work. Additional interfaces may be ; added by defining them in separate [rpcinterface:x] sections. [rpcinterface:supervisor] supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface ; The supervisorctl section configures how supervisorctl will connect to ; supervisord. configure it match the settings in either the unix_http_server ; or inet_http_server section. [supervisorctl] serverurl=unix:///var/run/supervisor/supervisor.sock ; use a unix:// URL for a unix socket ;serverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket ;username=chris ; should be same as in [*_http_server] if set ;password=123 ; should be same as in [*_http_server] if set ;prompt=mysupervisor ; cmd line prompt (default "supervisor") ;history_file=~/.sc_history ; use readline history if available ; The sample program section below shows all possible program subsection values. ; Create one or more 'real' program: sections to be able to control them under ; supervisor. ;[program:theprogramname] ;command=/bin/cat ; the program (relative uses PATH, can take args) ;process_name=%(program_name)s ; process_name expr (default %(program_name)s) ;numprocs=1 ; number of processes copies to start (def 1) ;directory=/tmp ; directory to cwd to before exec (def no cwd) ;umask=022 ; umask for process (default None) ;priority=999 ; the relative start priority (default 999) ;autostart=true ; start at supervisord start (default: true) ;startsecs=1 ; # of secs prog must stay up to be running (def. 1) ;startretries=3 ; max # of serial start failures when starting (default 3) ;autorestart=unexpected ; when to restart if exited after running (def: unexpected) ;exitcodes=0 ; 'expected' exit codes used with autorestart (default 0) ;stopsignal=QUIT ; signal used to kill process (default TERM) ;stopwaitsecs=10 ; max num secs to wait b4 SIGKILL (default 10) ;stopasgroup=false ; send stop signal to the UNIX process group (default false) ;killasgroup=false ; SIGKILL the UNIX process group (def false) ;user=chrism ; setuid to this UNIX account to run the program ;redirect_stderr=true ; redirect proc stderr to stdout (default false) ;stdout_logfile=/a/path ; stdout log path, NONE for none; default AUTO ;stdout_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stdout_logfile_backups=10 ; # of stdout logfile backups (0 means none, default 10) ;stdout_capture_maxbytes=1MB ; number of bytes in 'capturemode' (default 0) ;stdout_events_enabled=false ; emit events on stdout writes (default false) ;stdout_syslog=false ; send stdout to syslog with process name (default false) ;stderr_logfile=/a/path ; stderr log path, NONE for none; default AUTO ;stderr_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stderr_logfile_backups=10 ; # of stderr logfile backups (0 means none, default 10) ;stderr_capture_maxbytes=1MB ; number of bytes in 'capturemode' (default 0) ;stderr_events_enabled=false ; emit events on stderr writes (default false) ;stderr_syslog=false ; send stderr to syslog with process name (default false) ;environment=A="1",B="2" ; process environment additions (def no adds) ;serverurl=AUTO ; override serverurl computation (childutils) ; The sample eventlistener section below shows all possible eventlistener ; subsection values. Create one or more 'real' eventlistener: sections to be ; able to handle event notifications sent by supervisord. ;[eventlistener:theeventlistenername] ;command=/bin/eventlistener ; the program (relative uses PATH, can take args) ;process_name=%(program_name)s ; process_name expr (default %(program_name)s) ;numprocs=1 ; number of processes copies to start (def 1) ;events=EVENT ; event notif. types to subscribe to (req'd) ;buffer_size=10 ; event buffer queue size (default 10) ;directory=/tmp ; directory to cwd to before exec (def no cwd) ;umask=022 ; umask for process (default None) ;priority=-1 ; the relative start priority (default -1) ;autostart=true ; start at supervisord start (default: true) ;startsecs=1 ; # of secs prog must stay up to be running (def. 1) ;startretries=3 ; max # of serial start failures when starting (default 3) ;autorestart=unexpected ; autorestart if exited after running (def: unexpected) ;exitcodes=0 ; 'expected' exit codes used with autorestart (default 0) ;stopsignal=QUIT ; signal used to kill process (default TERM) ;stopwaitsecs=10 ; max num secs to wait b4 SIGKILL (default 10) ;stopasgroup=false ; send stop signal to the UNIX process group (default false) ;killasgroup=false ; SIGKILL the UNIX process group (def false) ;user=chrism ; setuid to this UNIX account to run the program ;redirect_stderr=false ; redirect_stderr=true is not allowed for eventlisteners ;stdout_logfile=/a/path ; stdout log path, NONE for none; default AUTO ;stdout_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stdout_logfile_backups=10 ; # of stdout logfile backups (0 means none, default 10) ;stdout_events_enabled=false ; emit events on stdout writes (default false) ;stdout_syslog=false ; send stdout to syslog with process name (default false) ;stderr_logfile=/a/path ; stderr log path, NONE for none; default AUTO ;stderr_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stderr_logfile_backups=10 ; # of stderr logfile backups (0 means none, default 10) ;stderr_events_enabled=false ; emit events on stderr writes (default false) ;stderr_syslog=false ; send stderr to syslog with process name (default false) ;environment=A="1",B="2" ; process environment additions ;serverurl=AUTO ; override serverurl computation (childutils) ; The sample group section below shows all possible group values. Create one ; or more 'real' group: sections to create "heterogeneous" process groups. ;[group:thegroupname] ;programs=progname1,progname2 ; each refers to 'x' in [program:x] definitions ;priority=999 ; the relative start priority (default 999) ; The [include] section can just contain the "files" setting. This ; setting can list multiple files (separated by whitespace or ; newlines). It can also contain wildcards. The filenames are ; interpreted as relative to this file. Included files *cannot* ; include files themselves. [include] files = supervisord.d/*.ini Supervisor å¯åŠ¨supervisor
$ supervisord # æœ‰æ—¶å€™å¯åŠ¨ä¼šæŠ¥é”™éœ€è¦unlink sock æ–‡ä»¶ unlink /var/run/supervisor/supervisor.sock å³å¯è¿è¡Œã€‚
supervisor é»˜è®¤åœ¨ä»¥ä¸‹è·¯å¾„æŸ¥æ‰¾é…ç½®æ–‡ä»¶ï¼š/usr/etc/supervisord.conf, /usr/supervisord.conf, supervisord.conf, etc/supervisord.conf, /etc/supervisord.conf, /etc/supervisor/supervisord.conf
å¦‚éœ€æŒ‡å®šä¸»é…ç½®æ–‡ä»¶ï¼Œåˆ™éœ€è¦ä½¿ç”¨-cå‚æ•°ï¼š
$ supervisord -c /etc/supervisord.conf å…³é—­
supervisorctl shutdown Supervisorctl å¯åŠ¨å®Œsupervusiorå
$ supervisorctl reread $ supervisorctl update è¿™ä¸¤ä¸ªå‘½ä»¤åˆ†åˆ«ä»£è¡¨é‡æ–°è¯»å–é…ç½®ã€æ›´æ–°å­è¿›ç¨‹ç»„ã€‚æ‰§è¡Œupdateåè¾“å‡ºï¼š
demo: added process group ç„¶åå¯åŠ¨åº”ç”¨ï¼Œå°±å®Œæˆäº†ï¼
$ supervisorctl strat demo ä»¥ä¸‹æ˜¯supervisorctlçš„ä»‹ç»å’Œç›¸å…³å‘½ä»¤
supervisorctl æ˜¯å®¢æˆ·ç«¯ç¨‹åºï¼Œç”¨äºå‘supervisordå‘èµ·å‘½ä»¤ã€‚
é€šè¿‡supervisorctl -hå¯ä»¥æŸ¥çœ‹å¸®åŠ©è¯´æ˜ã€‚æˆ‘ä»¬ä¸»è¦å…³å¿ƒçš„æ˜¯å…¶actionå‘½ä»¤ï¼š
$ supervisorctl help default commands (type help &lt;topic>): ===================================== add exit open reload restart start tail avail fg pid remove shutdown status update clear maintail quit reread signal stop versionå¤åˆ¶ä»£ç  è¿™äº›å‘½ä»¤å¯¹äºæ§åˆ¶å­è¿›ç¨‹éå¸¸é‡è¦ã€‚ç¤ºä¾‹:
reread ;é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ update ;å°†é…ç½®æ–‡ä»¶é‡Œæ–°å¢çš„å­è¿›ç¨‹åŠ å…¥è¿›ç¨‹ç»„ï¼Œå¦‚æœè®¾ç½®äº†autostart=trueåˆ™ä¼šå¯åŠ¨æ–°æ–°å¢çš„å­è¿›ç¨‹ status ;æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹çŠ¶æ€ status &lt;name> ;æŸ¥çœ‹æŒ‡å®šè¿›ç¨‹çŠ¶æ€ start all; å¯åŠ¨æ‰€æœ‰å­è¿›ç¨‹ start &lt;name>; å¯åŠ¨æŒ‡å®šå­è¿›ç¨‹ restart all; é‡å¯æ‰€æœ‰å­è¿›ç¨‹ restart &lt;name>; é‡å¯æŒ‡å®šå­è¿›ç¨‹ stop all; åœæ­¢æ‰€æœ‰å­è¿›ç¨‹ stop &lt;name>; åœæ­¢æŒ‡å®šå­è¿›ç¨‹ reload ;é‡å¯supervisord add &lt;name>; æ·»åŠ å­è¿›ç¨‹åˆ°è¿›ç¨‹ç»„ reomve &lt;name>; ä»è¿›ç¨‹ç»„ç§»é™¤å­è¿›ç¨‹ï¼Œéœ€è¦å…ˆstopã€‚æ³¨æ„ï¼šç§»é™¤åï¼Œéœ€è¦ä½¿ç”¨rereadå’Œupdateæ‰èƒ½é‡æ–°è¿è¡Œè¯¥è¿›ç¨‹å¤åˆ¶ä»£ç  supervisord æœ‰è¿›ç¨‹ç»„(process group)çš„æ¦‚å¿µï¼šåªæœ‰å­è¿›ç¨‹åœ¨è¿›ç¨‹ç»„ï¼Œæ‰èƒ½è¢«è¿è¡Œã€‚
supervisorctlä¹Ÿæ”¯æŒäº¤äº’å¼å‘½ä»¤è¡Œï¼š
$ supervisorctl demo RUNNING pid 27188, uptime 0:05:09 supervisor> version 3.3.4 supervisor> å‚è€ƒ https://juejin.cn/post/6844903745587773448</content></entry><entry><title>Markdownè¯­æ³•æ‰‹å†Œ</title><url>http://next.lisenhui.cn/post/markdown-syntax/</url><categories><category>themes</category><category>syntax</category></categories><tags><tag>markdown</tag><tag>css</tag><tag>html</tag></tags><content type="html"> æœ¬æ–‡æä¾›äº†ä¸€ä¸ªå¯ä»¥åœ¨ Hugo å†…å®¹æ–‡ä»¶ä¸­ä½¿ç”¨çš„åŸºæœ¬Markdownè¯­æ³•ç¤ºä¾‹ï¼Œè¿˜å±•ç¤ºäº†åŸºæœ¬ HTML å…ƒç´ åœ¨ Hugo ä¸»é¢˜ä¸­æ˜¯å¦ä½¿ç”¨ CSS è£…é¥°ã€‚
æ ‡é¢˜ ä¸‹é¢çš„ HTML ä»£ç &lt;h1>â€”&lt;h6> å…ƒç´ è¡¨ç¤ºå…­ä¸ªçº§åˆ«çš„èŠ‚æ ‡é¢˜ã€‚ &lt;h1>æ˜¯æœ€é«˜çš„èŠ‚çº§åˆ«ï¼Œ&lt;h6>æ˜¯æœ€ä½çš„èŠ‚çº§åˆ«ã€‚
H1 H2 H3 H4 H5 H6 æ®µè½ Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.
ä¼Šå¡”å›¾ï¼Ÿå¨æˆ¿é‡Œæœ‰å¾ˆå¤šä¸œè¥¿ï¼Œæˆ‘ä¸çŸ¥é“ä»–ä»¬å–œæ¬¢åƒä»€ä¹ˆï¼Œæˆ–è€…ä»–ä»¬å–œæ¬¢åƒä»€ä¹ˆã€‚
å¼•ç”¨ blockquoteå…ƒç´ è¡¨ç¤ºä»å¦ä¸€ä¸ªæ¥æºå¼•ç”¨çš„å†…å®¹ï¼Œå¯é€‰çš„å¼•ç”¨å¿…é¡»åœ¨footeræˆ–citeå…ƒç´ å†…ï¼Œä¹Ÿå¯é€‰çš„å†…åµŒæ›´æ”¹ï¼Œå¦‚æ³¨é‡Šå’Œç¼©å†™ã€‚
å¼•ç”¨æ²¡æœ‰å½’å± Tiam, ad mint andaepu dandae nostion secatur sequo quae. æ³¨æ„ å¯ä»¥åœ¨å—å¼•ç”¨ä¸­ä½¿ç”¨ Markdown è¯­æ³•ã€‚
å¸¦å½’å±çš„å¼•ç”¨ ä¸è¦é€šè¿‡åˆ†äº«è®°å¿†æ¥äº¤æµï¼Œé€šè¿‡äº¤æµæ¥åˆ†äº«è®°å¿†ã€‚
â€” ç½—å¸ƒÂ·æ´¾å…‹1
è¡¨æ ¼ è¡¨ä¸æ˜¯Markdownæ ¸å¿ƒè§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯Hugoæ”¯æŒå¼€ç®±å³ç”¨ã€‚
Name Age Bob 27 Alice 23 è¡¨æ ¼å†…ä½¿ç”¨Markdownè¯­æ³• Italics Bold Code italics bold code å›¾åƒ ![å›¾åƒæè¿°](å›¾åƒåœ°å€) ç¤ºä¾‹ Google Chrome Firefox Browser
ç‚¹å‡»å›¾åƒå¯ä»¥æ‰“å¼€å›¾åƒæµè§ˆå™¨ï¼Œå¿«è¯•è¯•å§ã€‚
ä»£ç å— å¸¦æœ‰å¼•å·çš„ä»£ç å— &lt;!doctype html> &lt;html lang="en"> &lt;head> &lt;meta charset="utf-8"> &lt;title>Example HTML5 Document&lt;/title> &lt;/head> &lt;body> &lt;p>Test&lt;/p> &lt;/body> &lt;/html> ç”¨å››ä¸ªç©ºæ ¼ç¼©è¿›çš„ä»£ç å— &lt;!doctype html> &lt;html lang="en"> &lt;head> &lt;meta charset="utf-8"> &lt;title>Example HTML5 Document&lt;/title> &lt;/head> &lt;body> &lt;p>Test&lt;/p> &lt;/body> &lt;/html> ä»£ç å—å¼•ç”¨Hugoçš„å†…éƒ¨é«˜äº®çŸ­ä»£ç  &lt;!doctype html> &lt;html lang="en"> &lt;head> &lt;meta charset="utf-8"> &lt;title>Example HTML5 Document&lt;/title> &lt;/head> &lt;body> &lt;p>Test&lt;/p> &lt;/body> &lt;/html> åˆ—è¡¨ç±»å‹ æœ‰åºåˆ—è¡¨ First item Second item Third item æ— åºåˆ—è¡¨ List item Another item And another item åµŒå¥—åˆ—è¡¨ Fruit Apple Orange Banana Dairy Milk Cheese å…¶ä»–å…ƒç´  â€” abbr, sub, sup, kbd, mark GIF æ˜¯ä½å›¾å›¾åƒæ ¼å¼ã€‚
H2O
Xn + Yn = Zn
æŒ‰ CTRL+ALT+Delete ç»„åˆé”®ç»“æŸä¼šè¯ã€‚
å¤§å¤šæ•°è¾èˆåœ¨å¤œé—´æ´»åŠ¨ï¼Œæ•é£Ÿæ˜†è™«ã€è •è™«å’Œå…¶ä»–å°åŠ¨ç‰©ã€‚
ä»¥ä¸Šå¼•æ–‡æ‘˜è‡ªRob Pikeåœ¨2015å¹´11æœˆ18æ—¥Gopherfestä¸Šçš„æ¼”è®²ã€‚&#160;&#8617;&#xfe0e;</content></entry><entry><title>å¯Œæ–‡æœ¬å†…å®¹æµ‹è¯•</title><url>http://next.lisenhui.cn/post/rich-content/</url><categories/><tags><tag>shortcodes</tag><tag>privacy</tag></tags><content type="html"> Hugoä¸Šæœ‰å‡ ä¸ªå†…ç½®çŸ­ä»£ç ï¼Œç”¨äºä¸°å¯Œå†…å®¹ï¼Œä»¥åŠéšç§é…ç½®è¿˜æœ‰ä¸€ç»„ç®€å•çš„çŸ­ä»£ç ï¼Œæ”¯æŒå„ç§ç¤¾äº¤åª’ä½“åµŒå…¥çš„é™æ€å’ŒéJSç‰ˆæœ¬ã€‚
YouTube Privacy Enhanced Shortcode Twitter Simple Shortcode .twitter-tweet { font: 14px/1.45 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; border-left: 4px solid #2b7bb9; padding-left: 1.5em; color: #555; } .twitter-tweet a { color: #2b7bb9; text-decoration: none; } blockquote.twitter-tweet a:hover, blockquote.twitter-tweet a:focus { text-decoration: underline; } Vimeo Simple Shortcode .__h_video { position: relative; padding-bottom: 56.23%; height: 0; overflow: hidden; width: 100%; background: #000; } .__h_video img { width: 100%; height: auto; color: #000; } .__h_video .play { height: 72px; width: 72px; left: 50%; top: 50%; margin-left: -36px; margin-top: -36px; position: absolute; cursor: pointer; }</content></entry><entry><title>å ä½ç¬¦æ–‡æœ¬æ˜¾ç¤º</title><url>http://next.lisenhui.cn/post/placeholder-text/</url><categories/><tags><tag>markdown</tag><tag>text</tag></tags><content type="html"> ä½ å¯¹æˆ‘çš„å¿ƒæœ‰åè§ã€‚æˆ‘å‘æ‚¨ä¿è¯ï¼Œæˆ‘ä»¬çš„ç”Ÿæ´»å°†ä¸ä¼šå—åˆ°å½±å“ï¼Œæˆ‘ä»¬çš„ç”Ÿæ´»å°†ä¼šå—åˆ°å½±å“ã€‚ä½ è¯´ä½ ç°åœ¨ä½åœ¨åŒ»é™¢é‡Œï¼Œå› ä¸ºä½ çš„çœ¼ç›æ˜¯é€æ˜çš„ï¼Œä½ çš„çœ¼ç›æ˜¯å…‰æ˜çš„ï¼Œä½ çš„çœ¼ç›æ˜¯å…‰æ˜çš„!
Exierant elisi ambit vivere dedere Duce pollice Eris modo Spargitque ferrea quos palude Rursus nulli murmur; hastile inridet ut ab gravi sententia! Nomine potitus silentia flumen, sustinet placuit petis in dilapsa erat sunt. Atria tractus malis.
Comas hunc haec pietate fetum procerum dixit Post torum vates letum Tiresia Flumen querellas Arcanaque montibus omnes Quidem et Vagus elidunt
The Van de Graaf Canon
Mane refeci capiebant unda mulcebat Victa caducifer, malo vulnere contra dicere aurato, ludit regale, voca! Retorsit colit est profanae esse virescere furit nec; iaculi matertera et visa est, viribus. Divesque creatis, tecta novat collumque vulnus est, parvas. Faces illo pepulere tempus adest. Tendit flamma, ab opes virum sustinet, sidus sequendo urbis.
Iubar proles corpore raptos vero auctor imperium; sed et huic: manus caeli Lelegas tu lux. Verbis obstitit intus oblectamina fixis linguisque ausus sperare Echionides cornuaque tenent clausit possit. Omnia putatur. Praeteritae refert ausus; ferebant e primus lora nutat, vici quae mea ipse. Et iter nil spectatae vulnus haerentia iuste et exercebat, sui et.
Eurytus Hector, materna ipsumque ut Politen, nec, nate, ignari, vernum cohaesit sequitur. Vel mitis temploque vocatus, inque alis, oculos nomen non silvis corpore coniunx ne displicet illa. Crescunt non unus, vidit visa quantum inmiti flumina mortis facto sic: undique a alios vincula sunt iactata abdita! Suspenderat ego fuit tendit: luna, ante urbem Propoetides parte.</content></entry><entry><title>æ•°æ®å…¬å¼è®¾ç½®æ˜¾ç¤º</title><url>http://next.lisenhui.cn/post/math-typesetting/</url><categories/><tags/><content type="html"> Hugoé¡¹ç›®ä¸­çš„æ•°å­¦è¡¨ç¤ºæ³•å¯ä»¥é€šè¿‡ä½¿ç”¨ç¬¬ä¸‰æ–¹JavaScriptåº“æ¥å®ç°ã€‚
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ MathJax
Create a post under /content/en[zh-CN]/math.md
å¯ä»¥å…¨å±€å¯ç”¨MathJaxï¼Œè¯·åœ¨é¡¹ç›®é…ç½®ä¸­å°†å‚æ•°mathè®¾ç½®ä¸ºtrue
æˆ–æ˜¯åœ¨æ¯é¡µåŸºç¡€ä¸Šå¯ç”¨MathJaxï¼Œåœ¨å†…å®¹æ–‡ä»¶ä¸­åŒ…æ‹¬å‚æ•°math: true
æ³¨æ„ï¼š ä½¿ç”¨æ”¯æŒçš„TeXåŠŸèƒ½çš„è”æœºå‚è€ƒèµ„æ–™
ä¾‹å­ é‡å¤çš„åˆ†æ•° $$ \frac{1}{\Bigl(\sqrt{\phi \sqrt{5}}-\phi\Bigr) e^{\frac25 \pi}} \equiv 1+\frac{e^{-2\pi}} {1+\frac{e^{-4\pi}} {1+\frac{e^{-6\pi}} {1+\frac{e^{-8\pi}} {1+\cdots} } } } $$
æ€»å’Œè®°å· $$ \left( \sum_{k=1}^n a_k b_k \right)^2 \leq \left( \sum_{k=1}^n a_k^2 \right) \left( \sum_{k=1}^n b_k^2 \right) $$
å‡ ä½•çº§æ•°ä¹‹å’Œ æˆ‘æŠŠæ¥ä¸‹æ¥çš„ä¸¤ä¸ªä¾‹å­åˆ†æˆäº†å‡ è¡Œï¼Œè¿™æ ·å®ƒåœ¨æ‰‹æœºä¸Šè¡¨ç°å¾—æ›´å¥½ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä»¬åŒ…å« \displaystyleã€‚
$$ \displaystyle\sum_{i=1}^{k+1}i $$
$$ \displaystyle= \left(\sum_{i=1}^{k}i\right) +(k+1) $$
$$ \displaystyle= \frac{k(k+1)}{2}+k+1 $$
$$ \displaystyle= \frac{k(k+1)+2(k+1)}{2} $$
$$ \displaystyle= \frac{(k+1)(k+2)}{2} $$
$$ \displaystyle= \frac{(k+1)((k+1)+1)}{2} $$
ä¹˜è®°å· $$ \displaystyle 1 + \frac{q^2}{(1-q)}+\frac{q^6}{(1-q)(1-q^2)}+\cdots = \displaystyle \prod_{j=0}^{\infty}\frac{1}{(1-q^{5j+2})(1-q^{5j+3})}, \displaystyle\text{ for }\lvert q\rvert &lt; 1. $$
éšæ–‡æ•°å¼ è¿™æ˜¯ä¸€äº›çº¿æ€§æ•°å­¦: $$ k_{n+1} = n^2 + k_n^2 - k_{n-1} $$ ï¼Œ ç„¶åæ˜¯æ›´å¤šçš„æ–‡æœ¬ã€‚
å¸Œè…Šå­—æ¯ $$ \Gamma\ \Delta\ \Theta\ \Lambda\ \Xi\ \Pi\ \Sigma\ \Upsilon\ \Phi\ \Psi\ \Omega \alpha\ \beta\ \gamma\ \delta\ \epsilon\ \zeta\ \eta\ \theta\ \iota\ \kappa\ \lambda\ \mu\ \nu\ \xi \ \omicron\ \pi\ \rho\ \sigma\ \tau\ \upsilon\ \phi\ \chi\ \psi\ \omega\ \varepsilon\ \vartheta\ \varpi\ \varrho\ \varsigma\ \varphi $$
ç®­å¤´ $$ \gets\ \to\ \leftarrow\ \rightarrow\ \uparrow\ \Uparrow\ \downarrow\ \Downarrow\ \updownarrow\ \Updownarrow $$
$$ \Leftarrow\ \Rightarrow\ \leftrightarrow\ \Leftrightarrow\ \mapsto\ \hookleftarrow \leftharpoonup\ \leftharpoondown\ \rightleftharpoons\ \longleftarrow\ \Longleftarrow\ \longrightarrow $$
$$ \Longrightarrow\ \longleftrightarrow\ \Longleftrightarrow\ \longmapsto\ \hookrightarrow\ \rightharpoonup $$
$$ \rightharpoondown\ \leadsto\ \nearrow\ \searrow\ \swarrow\ \nwarrow $$
ç¬¦å· $$ \surd\ \barwedge\ \veebar\ \odot\ \oplus\ \otimes\ \oslash\ \circledcirc\ \boxdot\ \bigtriangleup $$
$$ \bigtriangledown\ \dagger\ \diamond\ \star\ \triangleleft\ \triangleright\ \angle\ \infty\ \prime\ \triangle $$
å¾®ç§¯åˆ†å­¦ $$ \int u \frac{dv}{dx},dx=uv-\int \frac{du}{dx}v,dx $$
$$ f(x) = \int_{-\infty}^\infty \hat f(\xi),e^{2 \pi i \xi x} $$
$$ \oint \vec{F} \cdot d\vec{s}=0 $$
æ´›ä¼¦èŒ¨æ–¹ç¨‹ $$ \begin{aligned} \dot{x} &amp; = \sigma(y-x) \ \dot{y} &amp; = \rho x - y - xz \ \dot{z} &amp; = -\beta z + xy \end{aligned} $$
äº¤å‰ä¹˜ç§¯ è¿™åœ¨KaTeXä¸­æ˜¯å¯è¡Œçš„ï¼Œä½†åœ¨è¿™ç§ç¯å¢ƒä¸­é¦åˆ†çš„åˆ†ç¦»ä¸æ˜¯å¾ˆå¥½ã€‚
$$ \mathbf{V}_1 \times \mathbf{V}_2 = \begin{vmatrix} \mathbf{i} &amp; \mathbf{j} &amp; \mathbf{k} \ \frac{\partial X}{\partial u} &amp; \frac{\partial Y}{\partial u} &amp; 0 \ \frac{\partial X}{\partial v} &amp; \frac{\partial Y}{\partial v} &amp; 0 \end{vmatrix} $$
è¿™é‡Œæœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆ:ä½¿ç”¨â€œmfracâ€ç±»(åœ¨MathJaxæƒ…å†µä¸‹æ²¡æœ‰åŒºåˆ«)çš„é¢å¤–ç±»ä½¿åˆ†æ•°æ›´å°:
$$ \mathbf{V}_1 \times \mathbf{V}_2 = \begin{vmatrix} \mathbf{i} &amp; \mathbf{j} &amp; \mathbf{k} \ \frac{\partial X}{\partial u} &amp; \frac{\partial Y}{\partial u} &amp; 0 \ \frac{\partial X}{\partial v} &amp; \frac{\partial Y}{\partial v} &amp; 0 \end{vmatrix} $$
å¼ºè°ƒ $$ \hat{x}\ \vec{x}\ \ddot{x} $$
æœ‰å¼¹æ€§çš„æ‹¬å· $$ \left(\frac{x^2}{y^3}\right) $$
è¯„ä¼°èŒƒå›´ $$ \left.\frac{x^3}{3}\right|_0^1 $$
è¯Šæ–­æ ‡å‡† $$ f(n) = \begin{cases} \frac{n}{2}, &amp; \text{if } n\text{ is even} \ 3n+1, &amp; \text{if } n\text{ is odd} \end{cases} $$
éº¦å…‹æ–¯éŸ¦æ–¹ç¨‹ç»„ $$ \begin{aligned} \nabla \times \vec{\mathbf{B}} -, \frac1c, \frac{\partial\vec{\mathbf{E}}}{\partial t} &amp; = \frac{4\pi}{c}\vec{\mathbf{j}} \ \nabla \cdot \vec{\mathbf{E}} &amp; = 4 \pi \rho \ \nabla \times \vec{\mathbf{E}}, +, \frac1c, \frac{\partial\vec{\mathbf{B}}}{\partial t} &amp; = \vec{\mathbf{0}} \ \nabla \cdot \vec{\mathbf{B}} &amp; = 0 \end{aligned} $$
è¿™äº›æ–¹ç¨‹å¼å¾ˆç‹­çª„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨(ä¾‹å¦‚)æ·»åŠ å‚ç›´é—´è· [1em] åœ¨æ¯ä¸ªæ¢è¡Œç¬¦(\)ä¹‹åã€‚æ­£å¦‚ä½ åœ¨è¿™é‡Œçœ‹åˆ°çš„ï¼š
$$ \begin{aligned} \nabla \times \vec{\mathbf{B}} -, \frac1c, \frac{\partial\vec{\mathbf{E}}}{\partial t} &amp; = \frac{4\pi}{c}\vec{\mathbf{j}} \[1em] \nabla \cdot \vec{\mathbf{E}} &amp; = 4 \pi \rho \[0.5em] \nabla \times \vec{\mathbf{E}}, +, \frac1c, \frac{\partial\vec{\mathbf{B}}}{\partial t} &amp; = \vec{\mathbf{0}} \[1em] \nabla \cdot \vec{\mathbf{B}} &amp; = 0 \end{aligned} $$
ç»Ÿè®¡å­¦ å›ºå®šè¯ç»„ï¼š
$$ \frac{n!}{k!(n-k)!} = {^n}C_k {n \choose k} $$
åˆ†æ•°åœ¨åˆ†æ•° $$ \frac{\frac{1}{x}+\frac{1}{y}}{y-z} $$
ï½æ¬¡æ–¹æ ¹ $$ \sqrt[n]{1+x+x^2+x^3+\ldots} $$
çŸ©é˜µ $$ \begin{pmatrix} a_{11} &amp; a_{12} &amp; a_{13}\ a_{21} &amp; a_{22} &amp; a_{23}\ a_{31} &amp; a_{32} &amp; a_{33} \end{pmatrix} \begin{bmatrix} 0 &amp; \cdots &amp; 0 \ \vdots &amp; \ddots &amp; \vdots \ 0 &amp; \cdots &amp; 0 \end{bmatrix} $$
æ ‡ç‚¹ç¬¦å· $$ f(x) = \sqrt{1+x} \quad (x \ge -1) f(x) \sim x^2 \quad (x\to\infty) $$
ç°åœ¨ç”¨æ ‡ç‚¹ç¬¦å·:
$$ f(x) = \sqrt{1+x}, \quad x \ge -1 f(x) \sim x^2, \quad x\to\infty $$</content></entry><entry><title>æ”¯æŒEmojiè¡¨æƒ…ç¬¦å·</title><url>http://next.lisenhui.cn/post/emoji-support/</url><categories/><tags><tag>emoji</tag></tags><content type="html"> åœ¨Hugoé¡¹ç›®ä¸­å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å¯ç”¨Emojiã€‚
The emojify function can be called directly in templates or Inline Shortcodes.
To enable emoji globally, set enableEmoji to true in your site&rsquo;s configuration and then you can type emoji shorthand codes directly in content files; e.g.
é¦ƒæª² ğŸ™ˆ é¦ƒæª³ ğŸ™‰ é¦ƒæª´ ğŸ™Š
The Emoji cheat sheet is a useful reference for emoji shorthand codes.
N.B. The above steps enable Unicode Standard emoji characters and sequences in Hugo, however the rendering of these glyphs depends on the browser and the platform. To style the emoji you can either use a third party emoji font or a font stack; e.g.
.emoji { font-family: Apple Color Emoji, Segoe UI Emoji, NotoColorEmoji, Segoe UI Symbol, Android Emoji, EmojiSymbols; }</content></entry><entry><title>å…³äºæˆ‘</title><url>http://next.lisenhui.cn/about.html</url><categories/><tags/><content type="html"> Hugoæ˜¯ç”¨Goç¼–å†™çš„ä¸€ä¸ªå¼€æ”¾æºä»£ç é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ï¼Œå¯åœ¨Apacheè®¸å¯è¯2.0ä¸‹ä½¿ç”¨ã€‚ Hugoæ”¯æŒTOML, YAMLå’ŒJSONæ•°æ®æ–‡ä»¶ç±»å‹ï¼ŒMarkdownå’ŒHTMLå†…å®¹æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨çŸ­ä»£ç æ·»åŠ ä¸°å¯Œçš„å†…å®¹ã€‚å…¶ä»–å€¼å¾—æ³¨æ„çš„åŠŸèƒ½åŒ…æ‹¬åˆ†ç±»æ³•ã€å¤šè¯­è¨€æ¨¡å¼ã€å›¾åƒå¤„ç†ã€è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼ã€HTML/CSS/JSç¼©å°å’Œå¯¹Sass SCSSå·¥ä½œæµçš„æ”¯æŒã€‚
Hugoä½¿ç”¨äº†å¤šç§å¼€æºé¡¹ç›®ï¼ŒåŒ…æ‹¬:
https://github.com/yuin/goldmark https://github.com/alecthomas/chroma https://github.com/muesli/smartcrop https://github.com/spf13/cobra https://github.com/spf13/viper Hugoæ˜¯åšå®¢ã€ä¼ä¸šç½‘ç«™ã€åˆ›æ„ä½œå“é›†ã€åœ¨çº¿æ‚å¿—ã€å•é¡µåº”ç”¨ç¨‹åºç”šè‡³æ˜¯æ•°åƒé¡µçš„ç½‘ç«™çš„ç†æƒ³é€‰æ‹©ã€‚
Hugoé€‚åˆé‚£äº›æƒ³è¦æ‰‹å·¥ç¼–å†™è‡ªå·±çš„ç½‘ç«™ä»£ç ï¼Œè€Œä¸ç”¨æ‹…å¿ƒè®¾ç½®å¤æ‚çš„è¿è¡Œæ—¶ã€ä¾èµ–å…³ç³»å’Œæ•°æ®åº“çš„äººã€‚
ä½¿ç”¨Hugoå»ºç«‹çš„ç½‘ç«™éå¸¸å¿«é€Ÿã€å®‰å…¨ï¼Œå¯ä»¥éƒ¨ç½²åœ¨ä»»ä½•åœ°æ–¹ï¼ŒåŒ…æ‹¬AWSã€GitHub Pagesã€Herokuã€Netlifyå’Œä»»ä½•å…¶ä»–æ‰˜ç®¡æä¾›å•†ã€‚
æ›´å¤šä¿¡æ¯è¯·è®¿é—®GitHub.</content></entry><entry><title>StringIOå’ŒBytesIO</title><url>http://next.lisenhui.cn/post/stringio%E5%92%8Cbytesio/</url><categories/><tags/><content type="html"> é—®é¢˜æå‡º é—®é¢˜æ˜¯è¿™æ ·çš„ï¼Œæˆ‘éœ€è¦å°†è‡ªå·±ç”¨PILåŒ…åˆ›å»ºçš„å›¾ç‰‡å­˜å‚¨åˆ°æ•°æ®åº“ä¸­
è§£å†³è¿‡ç¨‹ åœ¨é¡¹ç›®è®¾ç½®ä¸­æ–‡ä»¶çš„å­˜å‚¨ä½ç½®æ˜¯FTPæœåŠ¡å™¨
djangoçš„é»˜è®¤å­˜å‚¨ä½ç½®ç”±DEFAULT_FILE_STORAGEå‚æ•°ç»™å‡ºï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç¼–å†™è‡ªå®šä¹‰çš„å­˜å‚¨ç³»ç»Ÿï¼ˆæœ¬ç¯‡æš‚æ—¶ä¸è®²ï¼‰
DEFAULT_FILE_STORAGE = 'storages.backends.ftp.FTPStorage' FTP_STORAGE_LOCATION = 'ftp://ftpfile:ç”¨æˆ·å@ip/lecare-admin_data/media/' è¿™ä¸ªæ—¶å€™æˆ‘ä»¬PILåˆ›å»ºçš„å›¾ç‰‡å­˜å‚¨åœ¨æœ¬æœºç£ç›˜å°±ä¸è¡Œäº†éœ€è¦å­˜å‚¨åœ¨FTPæœåŠ¡å™¨ä¸Šçš„ç£ç›˜åœ°å€æ‰èƒ½æ˜¾ç¤ºå’Œæ­£å¸¸ä½¿ç”¨,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨default_storage,å°†æ–‡ä»¶å­˜å‚¨åˆ°é»˜è®¤çš„å­˜å‚¨ä½ç½®
>>> from django.core.files.base import ContentFile >>> from django.core.files.storage import default_storage >>> path = default_storage.save('/path/to/file', ContentFile('new content')) >>> path '/path/to/file' >>> default_storage.size(path) 11 >>> default_storage.open(path).read() 'new content' >>> default_storage.delete(path) >>> default_storage.exists(path) False æˆ‘ä»¬å°†PILåˆ›å»ºçš„å›¾ç‰‡å­˜å‚¨åˆ°é»˜è®¤ä½ç½®ï¼Œä½†æ˜¯éœ€è¦è½¬æ¢æˆè¾“å…¥è¾“å‡ºæµåœ¨å­˜å‚¨
buf = BytesIO() # æ„å»ºä¸€ä¸ªè¾“å…¥è¾“å‡ºæµ im.save(buf, "jpeg") # å°†å›¾ç‰‡ä¿å­˜åˆ°è¾“å…¥è¾“å‡ºæµ,ä¹Ÿå°±æ˜¯å†…å­˜ä¸­ bur_str = buf.getvalue() # è·å¾—è¾“å…¥è¾“å‡ºæµé‡Œé¢çš„å†…å®¹ path = default_storage.save(file_name, ContentFile(bur_str)) å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š
def create_img_for_text(text, file_name, is_supplement=False): im = Image.new("RGB", (1000, 1000), (255, 255, 255)) dr = ImageDraw.Draw(im) font = ImageFont.truetype("/opt/uwsgi/log/lecare-api/yahei.ttf", 18) font_title = ImageFont.truetype("/opt/uwsgi/log/lecare-api/yahei.ttf", 30) font_supplement = ImageFont.truetype('/opt/uwsgi/log/lecare-api/yahei.ttf', 100) dr.text((450, 5), u'ç”³è¯·ä¿¡æ¯', font=font_title, fill="#000000") dr.text((10, 100), text, font=font, fill="#000000") if is_supplement: dr.text((800, 200), u'è¡¥', font=font_supplement, fill="#ff0000") buf = BytesIO() # æ„å»ºä¸€ä¸ªè¾“å…¥è¾“å‡ºæµ im.save(buf, "jpeg") # å°†å›¾ç‰‡ä¿å­˜åˆ°è¾“å…¥è¾“å‡ºæµ,ä¹Ÿå°±æ˜¯å†…å­˜ä¸­ bur_str = buf.getvalue() # è·å¾—è¾“å…¥è¾“å‡ºæµé‡Œé¢çš„å†…å®¹ path = default_storage.save(file_name, ContentFile(bur_str)) æ‹“å±•æ€è€ƒ å†™åˆ°è¿™é‡Œæˆ‘æƒ³èµ·ä¹‹å‰å†™ä¸€ä¸ªè·Ÿæ¢å¤´åƒçš„éœ€æ±‚ï¼Œå‰ç«¯ä¼ æ¥çš„åŠ å¯†çš„å›¾ç‰‡
//åœ¨htmlä»£ç imgæ ‡ç­¾é‡Œçš„å†™æ³• &lt;img src="data:image/gif;base64,R0lGODlhHAAmAKIHAKqqqsvLy0hISObm5vf394uLiwAAAP///yH5Bâ€¦EoqQqJKAIBaQOVKHAXr3t7txgBjboSvB8EpLoFZywOAo3LFE5lYs/QW9LT1TRk1V7S2xYJADs="> ä½¿ç”¨base64åŠ å¯†çš„å›¾ç‰‡ä¸éœ€è¦å•ç‹¬å‘é€httpè¯·æ±‚æ¥è¯·æ±‚å›¾ç‰‡ï¼Œå¯ä»¥ç›´æ¥å’Œé¡µé¢ä¸€èµ·ä¸‹è½½åˆ°æµè§ˆå™¨ï¼Œåœ¨cssä¸­çš„å†™æ³•æ˜¯è¿™æ ·çš„
//åœ¨cssé‡Œçš„å†™æ³• #fkbx-spch, #fkbx-hspch { background: url(data:image/gif;base64,R0lGODlhHAAmAKIHAKqqqsvLy0hISObm5vf394uLiwAAAP///yH5Bâ€¦EoqQqJKAIBaQOVKHAXr3t7txgBjboSvB8EpLoFZywOAo3LFE5lYs/QW9LT1TRk1V7S2xYJADs=) no-repeat center; } å½“ç„¶base64åŠ å¯†ä¸ä»…ç”¨äºå›¾ç‰‡åŠ å¯†ä¸Šï¼Œè¿…é›·çš„ä¸“ç”¨åœ°å€ä¹Ÿæ˜¯base64åŠ å¯†çš„
thunder://QUFodHRwOi8vZG93bi5zYW5kYWkubmV0L3RodW5kZXI3L1RodW5kZXI3LjEuNS4yMTUyLmV4ZVpa ä¸ºä»€ä¹ˆè¦ä½¿ç”¨base64åŠ å¯†å‘¢
å…¶å®base64åŠ å¯†çš„å›¾ç‰‡å¹¶ä¸æ¯”base64å­—ç¬¦ä¸²å¤§ï¼Œå¹¶ä¸”ä¸ºäº†å‡å°‘htmlè¯·æ±‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨CssSpritesï¼Œæ‰€ä»¥base64åŠ å¯†å›¾ç‰‡çš„ç”¨æ³•ä¼šåœ¨ä»¥ä¸‹æƒ…å†µä¸‹ï¼š
å¦‚æœå›¾ç‰‡è¶³å¤Ÿå°ä¸”å› ä¸ºç”¨å¤„çš„ç‰¹æ®Šæ€§æ— æ³•è¢«åˆ¶ä½œæˆé›ªç¢§å›¾ï¼ˆCssSpritesï¼‰ï¼Œåœ¨æ•´ä¸ªç½‘ç«™çš„å¤ç”¨æ€§å¾ˆé«˜ä¸”åŸºæœ¬ä¸ä¼šè¢«æ›´æ–°ã€‚
é‚£ä¹ˆæ­¤æ—¶ä½¿ç”¨ base64 ç¼–ç ä¼ è¾“å›¾ç‰‡å°±å¯è°“å¥½é’¢ç”¨åœ¨åˆ€åˆƒä¸Šï¼Œæ€å‰æƒ³åï¼Œç¬¦åˆè¿™ä¸ªè§„åˆ™çš„ï¼Œæœ‰ä¸€ä¸ªæ˜¯æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°çš„ï¼Œå°±æ˜¯é¡µé¢çš„èƒŒæ™¯å›¾
å‰ç«¯å’Œåç«¯å›¾ç‰‡è½¬æ¢
æˆ‘ä»¬ä»å‰ç«¯æ‹¿åˆ°çš„base64ç¼–ç åçš„å›¾ç‰‡æ€åœ¨åç«¯å­˜å‚¨å‘¢ï¼Ÿ åªéœ€è¦å»æ‰ data:image/gif;base64,å‰©ä¸‹çš„å°±æ˜¯å›¾ç‰‡base64çš„å†…å®¹äº†ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹
class AvatarChangeView(View): def get(self, request): return render(request, 'user/upload.html') def post(self, request): image_base64 = request.POST.get('image') base64_data = re.sub('^data:image/.+;base64,', '', image_base64) binary_data = base64.b64decode(base64_data) try: filename = utils.update_pic(binary_data, settings.MEDIA_ROOT + '/user/avatars') request.user.profile.image = 'user/avatars/' + filename request.user.profile.save() return JsonResponse({'res': 1}) except Exception as e: return JsonResponse({'res': 0, 'msg': e.message}) åŒæ ·çš„åç«¯çš„å›¾ç‰‡å¦‚æœæƒ³base64æ”¾åœ¨å‰ç«¯éœ€è¦å§å›¾ç‰‡è½¬æ¢æˆè¾“å…¥è¾“å‡ºæµå†base64åŠ å¯† åœ¨åŠ ä¸Šdata:image/gif;base64å°±å¯ä»¥äº†ã€‚
åŸåˆ›æ–‡ç« ï¼Œæ–‡ç¬”æœ‰é™ï¼Œæ‰ç–å­¦æµ…ï¼Œæ–‡ä¸­è‹¥æœ‰ä¸æ­£ä¹‹å¤„ï¼Œä¸‡æœ›å‘ŠçŸ¥ã€‚
å‚è€ƒèµ„æ–™ï¼š
https://docs.djangoproject.com/en/2.1/topics/files/
https://blog.csdn.net/rongDang/article/details/81225879
https://www.cnblogs.com/coco1s/p/4375774.html</content></entry><entry><title>Djangoå‰åç«¯çš„å›¾ç‰‡å­˜å‚¨é—®é¢˜</title><url>http://next.lisenhui.cn/post/django%E5%89%8D%E5%90%8E%E7%AB%AF%E7%9A%84%E5%9B%BE%E7%89%87%E5%AD%98%E5%82%A8%E9%97%AE%E9%A2%98/</url><categories/><tags/><content type="html"> é—®é¢˜æå‡º é—®é¢˜æ˜¯è¿™æ ·çš„ï¼Œæˆ‘éœ€è¦å°†è‡ªå·±ç”¨PILåŒ…åˆ›å»ºçš„å›¾ç‰‡å­˜å‚¨åˆ°æ•°æ®åº“ä¸­
è§£å†³è¿‡ç¨‹ åœ¨é¡¹ç›®è®¾ç½®ä¸­æ–‡ä»¶çš„å­˜å‚¨ä½ç½®æ˜¯FTPæœåŠ¡å™¨
djangoçš„é»˜è®¤å­˜å‚¨ä½ç½®ç”±DEFAULT_FILE_STORAGEå‚æ•°ç»™å‡ºï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç¼–å†™è‡ªå®šä¹‰çš„å­˜å‚¨ç³»ç»Ÿï¼ˆæœ¬ç¯‡æš‚æ—¶ä¸è®²ï¼‰
DEFAULT_FILE_STORAGE = 'storages.backends.ftp.FTPStorage' FTP_STORAGE_LOCATION = 'ftp://ftpfile:ç”¨æˆ·å@ip/lecare-admin_data/media/' è¿™ä¸ªæ—¶å€™æˆ‘ä»¬PILåˆ›å»ºçš„å›¾ç‰‡å­˜å‚¨åœ¨æœ¬æœºç£ç›˜å°±ä¸è¡Œäº†éœ€è¦å­˜å‚¨åœ¨FTPæœåŠ¡å™¨ä¸Šçš„ç£ç›˜åœ°å€æ‰èƒ½æ˜¾ç¤ºå’Œæ­£å¸¸ä½¿ç”¨,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨default_storage,å°†æ–‡ä»¶å­˜å‚¨åˆ°é»˜è®¤çš„å­˜å‚¨ä½ç½®
>>> from django.core.files.base import ContentFile >>> from django.core.files.storage import default_storage >>> path = default_storage.save('/path/to/file', ContentFile('new content')) >>> path '/path/to/file' >>> default_storage.size(path) 11 >>> default_storage.open(path).read() 'new content' >>> default_storage.delete(path) >>> default_storage.exists(path) False æˆ‘ä»¬å°†PILåˆ›å»ºçš„å›¾ç‰‡å­˜å‚¨åˆ°é»˜è®¤ä½ç½®ï¼Œä½†æ˜¯éœ€è¦è½¬æ¢æˆè¾“å…¥è¾“å‡ºæµåœ¨å­˜å‚¨
buf = BytesIO() # æ„å»ºä¸€ä¸ªè¾“å…¥è¾“å‡ºæµ im.save(buf, "jpeg") # å°†å›¾ç‰‡ä¿å­˜åˆ°è¾“å…¥è¾“å‡ºæµ,ä¹Ÿå°±æ˜¯å†…å­˜ä¸­ bur_str = buf.getvalue() # è·å¾—è¾“å…¥è¾“å‡ºæµé‡Œé¢çš„å†…å®¹ path = default_storage.save(file_name, ContentFile(bur_str)) å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š
def create_img_for_text(text, file_name, is_supplement=False): im = Image.new("RGB", (1000, 1000), (255, 255, 255)) dr = ImageDraw.Draw(im) font = ImageFont.truetype("/opt/uwsgi/log/lecare-api/yahei.ttf", 18) font_title = ImageFont.truetype("/opt/uwsgi/log/lecare-api/yahei.ttf", 30) font_supplement = ImageFont.truetype('/opt/uwsgi/log/lecare-api/yahei.ttf', 100) dr.text((450, 5), u'ç”³è¯·ä¿¡æ¯', font=font_title, fill="#000000") dr.text((10, 100), text, font=font, fill="#000000") if is_supplement: dr.text((800, 200), u'è¡¥', font=font_supplement, fill="#ff0000") buf = BytesIO() # æ„å»ºä¸€ä¸ªè¾“å…¥è¾“å‡ºæµ im.save(buf, "jpeg") # å°†å›¾ç‰‡ä¿å­˜åˆ°è¾“å…¥è¾“å‡ºæµ,ä¹Ÿå°±æ˜¯å†…å­˜ä¸­ bur_str = buf.getvalue() # è·å¾—è¾“å…¥è¾“å‡ºæµé‡Œé¢çš„å†…å®¹ path = default_storage.save(file_name, ContentFile(bur_str)) æ‹“å±•æ€è€ƒ å†™åˆ°è¿™é‡Œæˆ‘æƒ³èµ·ä¹‹å‰å†™ä¸€ä¸ªè·Ÿæ¢å¤´åƒçš„éœ€æ±‚ï¼Œå‰ç«¯ä¼ æ¥çš„åŠ å¯†çš„å›¾ç‰‡
//åœ¨htmlä»£ç imgæ ‡ç­¾é‡Œçš„å†™æ³• &lt;img src="data:image/gif;base64,R0lGODlhHAAmAKIHAKqqqsvLy0hISObm5vf394uLiwAAAP///yH5Bâ€¦EoqQqJKAIBaQOVKHAXr3t7txgBjboSvB8EpLoFZywOAo3LFE5lYs/QW9LT1TRk1V7S2xYJADs="> ä½¿ç”¨base64åŠ å¯†çš„å›¾ç‰‡ä¸éœ€è¦å•ç‹¬å‘é€httpè¯·æ±‚æ¥è¯·æ±‚å›¾ç‰‡ï¼Œå¯ä»¥ç›´æ¥å’Œé¡µé¢ä¸€èµ·ä¸‹è½½åˆ°æµè§ˆå™¨ï¼Œåœ¨cssä¸­çš„å†™æ³•æ˜¯è¿™æ ·çš„
//åœ¨cssé‡Œçš„å†™æ³• #fkbx-spch, #fkbx-hspch { background: url(data:image/gif;base64,R0lGODlhHAAmAKIHAKqqqsvLy0hISObm5vf394uLiwAAAP///yH5Bâ€¦EoqQqJKAIBaQOVKHAXr3t7txgBjboSvB8EpLoFZywOAo3LFE5lYs/QW9LT1TRk1V7S2xYJADs=) no-repeat center; } å½“ç„¶base64åŠ å¯†ä¸ä»…ç”¨äºå›¾ç‰‡åŠ å¯†ä¸Šï¼Œè¿…é›·çš„ä¸“ç”¨åœ°å€ä¹Ÿæ˜¯base64åŠ å¯†çš„
thunder://QUFodHRwOi8vZG93bi5zYW5kYWkubmV0L3RodW5kZXI3L1RodW5kZXI3LjEuNS4yMTUyLmV4ZVpa ä¸ºä»€ä¹ˆè¦ä½¿ç”¨base64åŠ å¯†å‘¢
å…¶å®base64åŠ å¯†çš„å›¾ç‰‡å¹¶ä¸æ¯”base64å­—ç¬¦ä¸²å¤§ï¼Œå¹¶ä¸”ä¸ºäº†å‡å°‘htmlè¯·æ±‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨CssSpritesï¼Œæ‰€ä»¥base64åŠ å¯†å›¾ç‰‡çš„ç”¨æ³•ä¼šåœ¨ä»¥ä¸‹æƒ…å†µä¸‹ï¼š
å¦‚æœå›¾ç‰‡è¶³å¤Ÿå°ä¸”å› ä¸ºç”¨å¤„çš„ç‰¹æ®Šæ€§æ— æ³•è¢«åˆ¶ä½œæˆé›ªç¢§å›¾ï¼ˆCssSpritesï¼‰ï¼Œåœ¨æ•´ä¸ªç½‘ç«™çš„å¤ç”¨æ€§å¾ˆé«˜ä¸”åŸºæœ¬ä¸ä¼šè¢«æ›´æ–°ã€‚
é‚£ä¹ˆæ­¤æ—¶ä½¿ç”¨ base64 ç¼–ç ä¼ è¾“å›¾ç‰‡å°±å¯è°“å¥½é’¢ç”¨åœ¨åˆ€åˆƒä¸Šï¼Œæ€å‰æƒ³åï¼Œç¬¦åˆè¿™ä¸ªè§„åˆ™çš„ï¼Œæœ‰ä¸€ä¸ªæ˜¯æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°çš„ï¼Œå°±æ˜¯é¡µé¢çš„èƒŒæ™¯å›¾
å‰ç«¯å’Œåç«¯å›¾ç‰‡è½¬æ¢
æˆ‘ä»¬ä»å‰ç«¯æ‹¿åˆ°çš„base64ç¼–ç åçš„å›¾ç‰‡æ€åœ¨åç«¯å­˜å‚¨å‘¢ï¼Ÿ åªéœ€è¦å»æ‰ data:image/gif;base64,å‰©ä¸‹çš„å°±æ˜¯å›¾ç‰‡base64çš„å†…å®¹äº†ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹
class AvatarChangeView(View): def get(self, request): return render(request, 'user/upload.html') def post(self, request): image_base64 = request.POST.get('image') base64_data = re.sub('^data:image/.+;base64,', '', image_base64) binary_data = base64.b64decode(base64_data) try: filename = utils.update_pic(binary_data, settings.MEDIA_ROOT + '/user/avatars') request.user.profile.image = 'user/avatars/' + filename request.user.profile.save() return JsonResponse({'res': 1}) except Exception as e: return JsonResponse({'res': 0, 'msg': e.message}) åŒæ ·çš„åç«¯çš„å›¾ç‰‡å¦‚æœæƒ³base64æ”¾åœ¨å‰ç«¯éœ€è¦å§å›¾ç‰‡è½¬æ¢æˆè¾“å…¥è¾“å‡ºæµå†base64åŠ å¯† åœ¨åŠ ä¸Šdata:image/gif;base64å°±å¯ä»¥äº†ã€‚
åŸåˆ›æ–‡ç« ï¼Œæ–‡ç¬”æœ‰é™ï¼Œæ‰ç–å­¦æµ…ï¼Œæ–‡ä¸­è‹¥æœ‰ä¸æ­£ä¹‹å¤„ï¼Œä¸‡æœ›å‘ŠçŸ¥ã€‚
å‚è€ƒèµ„æ–™ï¼š
https://docs.djangoproject.com/en/2.1/topics/files/
https://blog.csdn.net/rongDang/article/details/81225879
https://www.cnblogs.com/coco1s/p/4375774.html</content></entry></search>